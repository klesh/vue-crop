var e={name:"VueCrop",props:{src:{type:String},value:{type:Object},ratio:{type:Number}},computed:{bgOverlapStyle:function(){var e=this.bg,t=e.x;return{top:e.y+"px",left:t+"px",width:e.w+"px",height:e.h+"px"}},bgImageStyle:function(){return Object.assign({},this.bgOverlapStyle,{opacity:this.box.actived?.6:1})},boxStyle:function(){var e=this.box,t=this.bg;return{top:e.y*t.zr+t.y-1+"px",left:e.x*t.zr+t.x-1+"px",width:e.w*t.zr+"px",height:e.h*t.zr+"px"}},boxImageStyle:function(){var e=this.box,t=this.bg;return{top:-e.y*t.zr+"px",left:-e.x*t.zr+"px",width:t.w+"px",height:t.h+"px"}}},data:function(){return{initials:[],vp:{x:0,y:0,w:0,h:0},bg:{x:0,y:0,w:0,h:0,ow:null,oh:null,or:null,zr:1},box:{x:10,y:10,w:100,h:100,ax:0,ay:0,actived:!1,mode:null}}},mounted:function(){var e=this;this.reload(!0),this.$watch("value",function(){return e.reload()},{deep:!0}),this.$watch("src",function(){return e.reload()})},methods:{reload:function(){for(var e=this,t=this.$el,i=[0,0],o=i[0],n=i[1];t;)o+=t.offsetLeft,n+=t.offsetTop,t=t.offsetParent;this.vp={x:o,y:n,w:this.$el.offsetWidth,h:this.$el.offsetHeight};var a=new Image;if(a.onload=function(){var t=e,i=t.bg,o=t.vp;i.ow=a.width,i.oh=a.height,i.or=i.ow/i.oh,o.r=o.w/o.h,i.or>o.r?(i.w=Math.min(i.ow,o.w),i.h=i.w/i.or):(i.h=Math.min(i.oh,o.h),i.w=i.h*i.or),i.zr=i.w/i.ow,i.x=(o.w-i.w)/2,i.y=(o.h-i.h)/2},a.src=this.src,this.value){var s=this.value,r=s.x,l=s.y,d=s.w,u=s.h;this.box=Object.assign({},this.box,{x:r,y:l,w:d,h:u,actived:!0})}else this.box.actived=!1},mouseWheel:function(e){var t=this.bg,i=this.vp,o=t.w;t.w+=e.wheelDeltaY,t.h=t.w/t.or;var n=t.w/o-1;t.x-=(e.x-i.x-t.x)*n,t.y-=(e.y-i.y-t.y)*n,t.zr=t.w/t.ow},mouseDown:function(e){this.initials[e.button]={e,bg:Object.assign({},this.bg),box:Object.assign({},this.box)}},mouseUp:function(e){this.initials[e.button]=null,this.box.mode=null},mouseMove:function(e){var t=this.initials,i=t[0],o=t[2],n=this.bg,a=this.box,s=this.vp;if(o&&(n.x=o.bg.x+e.x-o.e.x,n.y=o.bg.y+e.y-o.e.y),i){if(!a.actived&&Math.abs(e.x-i.e.x)>5&&Math.abs(e.y-i.e.y)>5){var r=(i.e.x-s.x-n.x)/n.zr,l=(i.e.y-s.y-n.y)/n.zr;r>0&&l>0&&(this.box={ax:r,ay:l,mode:"resizing",actived:!0})}if(a.mode){var d=i.box,u=d.x,c=d.y,f=d.w,h=d.h;if("resizing"===a.mode){var v,x,b=a.ax,y=a.ay;if(~b&&(v=(e.x-s.x-n.x)/n.zr,u=Math.min(v,b),f=Math.abs(v-b)),~y&&(x=(e.y-s.y-n.y)/n.zr,c=Math.min(x,y),h=Math.abs(x-y)),this.ratio)if(Math.abs(e.x-i.e.x)>Math.abs(e.y-i.e.y)){var p=f/this.ratio;x<y&&(c+=h-p),h=p}else{var m=h*this.ratio;v<b&&(u+=f-m),f=m}if(u<0||u+f>n.ow||c<0||c+h>n.oh)return}else"moving"===a.mode&&(u=i.box.x+(e.x-i.e.x)/n.zr,c=i.box.y+(e.y-i.e.y)/n.zr,u=Math.min(Math.max(0,u),n.ow-a.w),c=Math.min(Math.max(0,c),n.oh-a.h));this.box=Object.assign({},this.box,{x:u,y:c,w:f,h})}}},setResizing:function(e){var t=this.box;t.ax=-1,t.ay=-1,~e.indexOf("n")&&(t.ay=t.y+t.h),~e.indexOf("s")&&(t.ay=t.y),~e.indexOf("w")&&(t.ax=t.x+t.w),~e.indexOf("e")&&(t.ax=t.x),t.mode="resizing"},setMoving:function(){this.box.mode="moving"},ok:function(){var e=this.box,t=e.x,i=e.y,o=e.w,n=e.h;this.$emit("input",Object.assign({},this.value,{x:t,y:i,w:o,h:n})),this.$emit("change")}}};var t,i=function(e,t,i,o,n,a,s,r,l,d){"boolean"!=typeof s&&(l=r,r=s,s=!1);var u,c="function"==typeof i?i.options:i;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),o&&(c._scopeId=o),a?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(a)},c._ssrRegister=u):t&&(u=s?function(){t.call(this,d(this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),u)if(c.functional){var f=c.render;c.render=function(e,t){return u.call(t),f(e,t)}}else{var h=c.beforeCreate;c.beforeCreate=h?[].concat(h,u):[u]}return i},o="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());var n={};var a=i({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"vp",on:{mousewheel:e.mouseWheel,mousedown:e.mouseDown,mouseup:e.mouseUp,mousemove:e.mouseMove,contextmenu:function(e){e.preventDefault()}}},[i("div",{staticClass:"movable bgoverlap",style:e.bgOverlapStyle}),e._v(" "),i("img",{staticClass:"movable",style:e.bgImageStyle,attrs:{src:e.src,draggable:"false"}}),e._v(" "),e.box.actived?i("div",{staticClass:"movable box",style:e.boxStyle},[i("div",{staticClass:"vp fill",on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.setMoving(t)},dblclick:e.ok}},[i("img",{staticClass:"movable",style:e.boxImageStyle,attrs:{src:e.src,draggable:"false"}})]),e._v(" "),i("div",{staticClass:"indicator top left",on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.setResizing("nw")}}}),e._v(" "),i("div",{staticClass:"indicator top center",on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.setResizing("n")}}}),e._v(" "),i("div",{staticClass:"indicator top right",on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.setResizing("ne")}}}),e._v(" "),i("div",{staticClass:"indicator middle left ",on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.setResizing("w")}}}),e._v(" "),i("div",{staticClass:"indicator middle right ",on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.setResizing("e")}}}),e._v(" "),i("div",{staticClass:"indicator bottom left",on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.setResizing("sw")}}}),e._v(" "),i("div",{staticClass:"indicator bottom center",on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.setResizing("s")}}}),e._v(" "),i("div",{staticClass:"indicator bottom right",on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.setResizing("se")}}})]):e._e()])},staticRenderFns:[]},function(e){e&&e("data-v-69a397aa_0",{source:".vp[data-v-69a397aa]{position:relative;overflow:hidden;user-select:none}.vp .movable[data-v-69a397aa]{position:absolute}.vp .bgoverlap[data-v-69a397aa]{background:#000}.vp .box[data-v-69a397aa]{border:solid 1px #00f}.vp .fill[data-v-69a397aa]{width:100%;height:100%}.vp .box .indicator[data-v-69a397aa]{position:absolute;background:#00f;border:solid 1px #fff;width:8px;height:8px;margin:-4px 0 0 -4px;box-sizing:border-box}.indicator.top[data-v-69a397aa]{top:0}.indicator.middle[data-v-69a397aa]{top:50%}.indicator.bottom[data-v-69a397aa]{top:100%}.indicator.left[data-v-69a397aa]{left:0}.indicator.center[data-v-69a397aa]{left:50%}.indicator.right[data-v-69a397aa]{left:100%}.indicator.top.left[data-v-69a397aa]{cursor:nw-resize}.indicator.top.center[data-v-69a397aa]{cursor:n-resize}.indicator.top.right[data-v-69a397aa]{cursor:ne-resize}.indicator.middle.left[data-v-69a397aa]{cursor:w-resize}.indicator.middle.right[data-v-69a397aa]{cursor:e-resize}.indicator.bottom.left[data-v-69a397aa]{cursor:sw-resize}.indicator.bottom.center[data-v-69a397aa]{cursor:s-resize}.indicator.bottom.right[data-v-69a397aa]{cursor:se-resize}",map:void 0,media:void 0})},e,"data-v-69a397aa",!1,void 0,function(e){return function(e,i){return function(e,i){var a=o?i.media||"default":e,s=n[a]||(n[a]={ids:new Set,styles:[]});if(!s.ids.has(e)){s.ids.add(e);var r=i.source;if(i.map&&(r+="\n/*# sourceURL="+i.map.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i.map))))+" */"),s.element||(s.element=document.createElement("style"),s.element.type="text/css",i.media&&s.element.setAttribute("media",i.media),void 0===t&&(t=document.head||document.getElementsByTagName("head")[0]),t.appendChild(s.element)),"styleSheet"in s.element)s.styles.push(r),s.element.styleSheet.cssText=s.styles.filter(Boolean).join("\n");else{var l=s.ids.size-1,d=document.createTextNode(r),u=s.element.childNodes;u[l]&&s.element.removeChild(u[l]),u.length?s.element.insertBefore(d,u[l]):s.element.appendChild(d)}}}(e,i)}},void 0);function s(e){s.installed||(s.installed=!0,e.component("VueCrop",a))}var r={install:s},l=null;"undefined"!=typeof window?l=window.Vue:"undefined"!=typeof global&&(l=global.Vue),l&&l.use(r),a.install=s;export default a;
